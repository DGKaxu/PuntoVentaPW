{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ticket #{{num_ticket}}</title>
    <style>
        /* Estilos para que parezca Ticket */
        body {
            font-family: 'Courier New', Courier, monospace; /* Fuente tipo ticket */
            font-size: 12px;
            width: 80mm; /* Ancho est√°ndar de impresora t√©rmica (o 58mm) */
            margin: 0 auto; /* Centrado */
            background-color: #fff;
        }
        
        .centrado { text-align: center; }
        .derecha { text-align: right; }
        
        table { width: 100%; border-collapse: collapse; }
        td { padding: 2px 0; }
        
        .linea { border-top: 1px dashed black; margin: 5px 0; }

        /* Ocultar botones al imprimir */
        @media print {
            .no-print { display: none; }
            @page { margin: 0; } /* Quita m√°rgenes del navegador */
        }
    </style>
</head>
<body>
    <div class="centrado no-print">
        <button onclick="window.print()" style="font-size: 20px; padding: 10px; margin-bottom: 20px;">üñ®Ô∏è IMPRIMIR</button>
        <hr>
    </div>

    <div class="centrado">
        {% if empresa.imagen %}
        <img src="{{empresa.imagen.url}}" alt="Logo" width="50"><br>
        {% endif %}
        <h3>{{empresa.nombre}}</h3>
        <p>
            {{empresa.domicilio}}<br>
            Tel: {{empresa.telefono}}
        </p>
        <p>
            Ticket: #{{num_ticket}}<br>
            Fecha: {{fecha}}<br>
            Cliente: {{cliente}}
        </p>
    </div>

    <div class="linea"></div>

    <table>
        <thead>
            <tr>
                <th style="text-align: left;">Cant.</th>
                <th style="text-align: left;">Articulo</th>
                <th style="text-align: right;">Total</th>
            </tr>
        </thead>
        <tbody>
            {% for i in items %}
            <tr>
                <td>{{i.cantidad|floatformat:0}}</td>
                <td>{{i.producto.descripcion}}</td>
                <td class="derecha">${{i.total|intcomma}}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="linea"></div>

    <div class="derecha">
        {% if iva == "True" %}
            <p>Subtotal: ${{subtotal|floatformat:2|intcomma}}</p>
            <p>IVA (16%): ${{iva_suma|floatformat:2|intcomma}}</p>
        {% endif %}
        <h3>Total: ${{total|floatformat:2|intcomma}}</h3>
    </div>

    <div class="centrado">
        <p>¬°GRACIAS POR SU COMPRA!</p>
        {% if comentarios %}
        <p><small>Nota: {{comentarios}}</small></p>
        {% endif %}
    </div>

    <script>
        window.onload = function() {
            window.print();
            // Opcional: Cerrar la ventana despu√©s de imprimir (funciona en algunos navegadores)
            // window.onafterprint = function(){ window.close(); };
        }
    </script>
</body>
</html>